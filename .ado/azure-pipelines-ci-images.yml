# PCPC CI Images Build Pipeline
# Builds CI container images, pushes to ACR, and publishes digests for consumption.

trigger: none
pr: none

variables:
  # Registry and version tagging
  - name: ACR_NAME
    value: maberdevcontainerregistry
  - name: IMAGE_VERSION
    value: $(Build.BuildNumber)

stages:
  - stage: Build
    displayName: "Build CI Images"
    jobs:
      - template: templates/build-ci-images.yml
        parameters:
          acrRegistryServiceConnection: pcpc-acr-service-connection
          azureSubscription: pcpc-azure-subscription
          acrName: $(ACR_NAME)
          imageVersion: $(IMAGE_VERSION)
          pushLatest: true
